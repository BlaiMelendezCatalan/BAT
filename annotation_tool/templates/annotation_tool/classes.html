{% extends 'annotation_tool/base.html' %}
{% load rest_framework %}
{% load staticfiles %}

{% block title %}Classes{% endblock %}

{% block header %}Classes{% endblock %}

{% block extra_js %}
  <script src="{% static 'js/jquery-ui.min.js' %}"></script>
  <script src="{% static 'js/bootstrap-tokenfield.min.js' %}"></script>
  <script src="{% static 'js/bootstrap-colorpicker.min.js' %}"></script>
  <script>
    var TAGS_NAMES = {% if tags_names %}'{{ tags_names }}'.split(','){% else %}[]{% endif %};
  </script>
{% endblock %}

{% block extra_css %}
  <link rel="stylesheet" href="{% static 'css/jquery-ui.min.css' %}">
  <link rel="stylesheet" href="{% static 'css/bootstrap-tokenfield.min.css' %}">
  <link rel="stylesheet" href="{% static 'css/bootstrap-colorpicker.min.css' %}">
{% endblock %}

{% block body_block %}
  <h3>Add new class</h3>
  <div class="row">
    <div class="col-md-4">
      <form action="" method="post">
        {% csrf_token %}
        {% render_form serializer %}
        {% if serializer.errors and serializer.errors.non_field_errors %}
            <div class="alert alert-danger">
              {{ serializer.errors.non_field_errors.0 }}
            </div>
        {% endif %}
        <input type="submit" value="Create new class" class="btn btn-success"/>
      </form>
    </div>
  </div>
  <hr>
  {% if query_data %}
    <table class="table table-striped table-bordered sortable" style="width: auto;">
      <tr>
        <th>ID</th>
        <th>Class name</th>
        <th>Project</th>
        <th>Tags</th>
        <th>Color</th>
        <th>Shortcut</th>
        <th></th>
      </tr>
      {% for class in query_data %}
        <tr>
          <td>{{ class.id }}</td>
          <td>{{ class.name }}</td>
          <td>{{ class.project }}</td>
          <td>{% for tag in class.tags.all %}{{ tag.name }}{% if not forloop.last %}, {% endif %}{% endfor %}</td>
          <td>{{ class.color }}</td>
          <td>{{ class.shortcut }}</td>
          <td><button data-delete-url="{% url 'class' class.id %}" class="btn btn-danger delete-item"
                    data-toggle="modal" data-target="#delete-modal">Delete
            </button></td>
        </tr>
      {% endfor %}
    </table>
    <p>Displaying {{ query_data|length }} classes ordered by ID.</p>
    {% include 'annotation_tool/_modal_delete.html' with text='Are you sure you want to delete this class?' %}
  {% else %}
    <p>No data is available.</p>
  {% endif %}
{% endblock %}